<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dashboard</title>
  <link rel="stylesheet" href="/css/styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Billabong&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
  <div class="container">
    <div class="sidebar">
      <div class="logo">Instagram</div>
      <nav class="nav-links">
        <a href="/dashboard"><i class="fas fa-home"></i> Home</a>
        <a href="/search"><i class="fas fa-search"></i> Search</a>
        <a href="#"><i class="fas fa-compass"></i> Explore</a>
        <a href="#"><i class="far fa-play-circle"></i> Reels</a>
        <a href="#"><i class="far fa-paper-plane"></i> Messages</a>
        <div class="notification-wrapper">
          <!-- <a href="/notification" id="notification-toggle">
            <i class="far fa-heart"></i> Notifications
            <% if (typeof unreadCount !== 'undefined' && unreadCount > 0) { %>
              <span class="badge"><%= unreadCount %></span>
            <% } %>
          </a> -->
          <a href="/notification">
    <i class="far fa-heart"></i> Notifications
    <% if (typeof unreadCount !== 'undefined' && unreadCount > 0) { %>
      <span class="badge"><%= unreadCount %></span>
    <% } %>
  </a>
  <a href="/logout">Logout</a>
        </div>
        
        
        <a href="/posts/upload"><i class="far fa-plus-square"></i> Create</a>
        <a href="/profile"><i class="far fa-user-circle"></i> Profile</a>
        <a href="#"><i class="fas fa-bars"></i> More</a>
      </nav>
    </div>

    <div class="main-content">
      <!-- Stories Bar -->
      <div class="stories-bar">
        <!-- Add Story Button -->
        <div class="add-story">
          <a href="/upload-story"><i class="fas fa-plus-circle"></i> Add Story</a>
        </div>

        <% if (stories && stories.length > 0) { %>
          <% stories.forEach(s => { %>
            <div class="story-preview">
              <a href="/story/<%= s._id %>">
                <img src="/uploads/<%= s.user.profilePic %>" alt="story" onerror="this.src='/images/default-profile.png';" />
                <p><%= s.user.username %></p>
              </a>
            </div>
          <% }) %>
        <% } else { %>
          <p>No active stories</p>
        <% } %>
      </div>

      <!-- Posts Feed -->
      <div class="feed">
        <% if (posts && posts.length > 0) { %>
          <% posts.forEach(post => { %>
            <div class="post">
              <% if (post.user) { %>
                <div class="post-header">
                  <!-- <img src="/uploads/<= post.user.profilePic %>" alt="story" onerror="this.src='/images/default-profile.png';" /> -->
                  <p><%= post.user.username %></p>
                </div>
              <% } else { %>
                <div class="post-header">
                  <img src="/images/default-ProfilePic.png" alt="default-profile" />
                  <p>Unknown User</p>
                </div>
              <% } %>
              
              <img src="<%= post.postImage %>" alt="<%= post.caption %>" class="post-img">
              <div class="post-actions">
                <i class="far fa-heart"></i>
                <i class="far fa-comment"></i>
                <i class="far fa-paper-plane"></i>
                <i class="far fa-bookmark"></i>
              </div>
              <div class="likes">100 likes</div>
              <div class="caption">
                <span><%= post.username %></span> <%= post.caption %>
              </div>
            </div>
          <% }); %>
        <% } else { %>
          <p>No posts to show yet.</p>
        <% } %>
      </div>
      <!-- <section id="notifications">
        <h3>Recent Notifications</h3>
        <ul>
         
        </ul>
      </section> -->
    </div>

    <div class="right-sidebar">
      <div class="suggestions">
        <p>Suggested for you</p>
        <div class="suggested-user">
          <p><a>User 1</a> <a href="#">Follow</a></p>
        </div>
        <div class="suggested-user">
          <p><a>User 2</a> <a href="#">Follow</a></p>
        </div>
      </div>
    </div>
  </div>
  <script>
    const toggle = document.getElementById('notification-toggle');
    const dropdown = document.getElementById('notification-dropdown');
  
    toggle.addEventListener('mouseenter', () => {
      dropdown.style.display = 'block';
    });
  
    toggle.addEventListener('mouseleave', () => {
      setTimeout(() => dropdown.style.display = 'none', 300);
    });
  
    dropdown.addEventListener('mouseenter', () => {
      dropdown.style.display = 'block';
    });
  
    dropdown.addEventListener('mouseleave', () => {
      dropdown.style.display = 'none';
    });
  </script>
  
</body>
</html>